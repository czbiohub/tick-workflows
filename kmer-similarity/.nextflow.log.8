Jun-07 16:59:40.390 [main] DEBUG nextflow.cli.Launcher - $> nextflow run czbiohub/nf-kmer-similarity -latest -r olgabot/fix-fasta --fastas 's3://tick-genome/rna/pacbio-isoseq/2018-06-07/fake_genome_and_transcriptome/*.fake_ref_transcriptome.fasta' --one_signature_per_record --outdir 's3://tick-genome/rna/pacbio-isoseq/2018-06-07/fake_genome_and_transcriptome/transcriptome_kmer_similarity/' -work-dir 's3://tick-genome/nextflow-intermediates/' -profile czbiohub_aws -e.process.executor=awsbatch --log2_sketch_sizes 8,9
Jun-07 16:59:40.568 [main] INFO  nextflow.cli.CmdRun - N E X T F L O W  ~  version 19.03.0-edge
Jun-07 16:59:41.766 [main] DEBUG nextflow.scm.AssetManager - Git config: /Users/olgabot/.nextflow/assets/czbiohub/nf-kmer-similarity/.git/config; branch: master; remote: origin; url: https://github.com/czbiohub/nf-kmer-similarity.git
Jun-07 16:59:41.781 [main] DEBUG nextflow.scm.AssetManager - Git config: /Users/olgabot/.nextflow/assets/czbiohub/nf-kmer-similarity/.git/config; branch: master; remote: origin; url: https://github.com/czbiohub/nf-kmer-similarity.git
Jun-07 16:59:41.781 [main] INFO  nextflow.cli.CmdRun - Pulling czbiohub/nf-kmer-similarity ...
Jun-07 16:59:41.782 [main] DEBUG nextflow.scm.AssetManager - Pull pipeline czbiohub/nf-kmer-similarity  -- Using local path: /Users/olgabot/.nextflow/assets/czbiohub/nf-kmer-similarity
Jun-07 16:59:42.908 [main] DEBUG nextflow.scm.AssetManager - Git config: /Users/olgabot/.nextflow/assets/czbiohub/nf-kmer-similarity/.git/config; branch: master; remote: origin; url: https://github.com/czbiohub/nf-kmer-similarity.git
Jun-07 16:59:42.908 [main] INFO  nextflow.cli.CmdRun - Launching `czbiohub/nf-kmer-similarity` [mighty_snyder] - revision: 4a3c7aeb78 [olgabot/fix-fasta]
Jun-07 16:59:42.920 [main] DEBUG nextflow.config.ConfigBuilder - Found config home: /Users/olgabot/.nextflow/config
Jun-07 16:59:42.920 [main] DEBUG nextflow.config.ConfigBuilder - Found config base: /Users/olgabot/.nextflow/assets/czbiohub/nf-kmer-similarity/nextflow.config
Jun-07 16:59:42.921 [main] DEBUG nextflow.config.ConfigBuilder - Parsing config file: /Users/olgabot/.nextflow/config
Jun-07 16:59:42.921 [main] DEBUG nextflow.config.ConfigBuilder - Parsing config file: /Users/olgabot/.nextflow/assets/czbiohub/nf-kmer-similarity/nextflow.config
Jun-07 16:59:42.921 [main] DEBUG nextflow.config.ConfigBuilder - Adding following variables to session environment: [process.executor:awsbatch]
Jun-07 16:59:42.931 [main] DEBUG nextflow.config.ConfigBuilder - Applying config profile: `czbiohub_aws`
Jun-07 16:59:42.972 [main] DEBUG nextflow.config.ConfigBuilder - Applying config profile: `czbiohub_aws`
Jun-07 16:59:43.665 [main] DEBUG nextflow.config.ConfigBuilder - Available config profiles: [czbiohub_aws, hebbe, cfc, uppmax_devel, uzh, test, bigpurple, crick, uppmax, local, docker, gis, phoenix, shh, ccga, mendel, uct_hex, aws, munin, binac, prince]
Jun-07 16:59:43.711 [main] DEBUG nextflow.Session - Session uuid: 59e91048-974c-4c98-98ef-bce86b3369ea
Jun-07 16:59:43.711 [main] DEBUG nextflow.Session - Run name: mighty_snyder
Jun-07 16:59:43.712 [main] DEBUG nextflow.Session - Executor pool size: 8
Jun-07 16:59:43.734 [main] DEBUG nextflow.file.FileHelper - Creating a file system instance for provider: S3FileSystemProvider
Jun-07 16:59:43.741 [main] DEBUG nextflow.Global - Using AWS credential defined in `default` section in file: /Users/olgabot/.aws/credentials
Jun-07 16:59:43.746 [main] DEBUG nextflow.file.FileHelper - AWS S3 config details: {secret_key=Zl6hSJ.., signer_override=S3SignerType, max_connections=20, upload_storage_class=INTELLIGENT_TIERING, storage_encryption=AES256, access_key=AKIAI2.., region=us-west-2, connection_timeout=10000}
Jun-07 16:59:54.262 [main] DEBUG nextflow.cli.CmdRun - 
  Version: 19.03.0-edge build 5061
  Modified: 14-03-2019 17:26 UTC (10:26 PDT)
  System: Mac OS X 10.14.4
  Runtime: Groovy 2.5.6 on Java HotSpot(TM) 64-Bit Server VM 1.8.0_131-b11
  Encoding: UTF-8 (UTF-8)
  Process: 21626@Olgas-MacBook-Pro.local [192.168.101.150]
  CPUs: 8 - Mem: 16 GB (130.4 MB) - Swap: 4 GB (553 MB)
Jun-07 16:59:54.791 [main] DEBUG nextflow.Session - Work-dir: s3://tick-genome/nextflow-intermediates [Mac OS X]
Jun-07 16:59:54.791 [main] DEBUG nextflow.Session - Script base path does not exist or is not a directory: /Users/olgabot/.nextflow/assets/czbiohub/nf-kmer-similarity/bin
Jun-07 16:59:54.997 [main] DEBUG nextflow.Session - Session start invoked
Jun-07 16:59:55.001 [main] DEBUG nextflow.processor.TaskDispatcher - Dispatcher > start
Jun-07 16:59:55.003 [main] DEBUG nextflow.trace.TraceFileObserver - Flow starting -- trace file: /Users/olgabot/code/tick-workflows/kmer-similarity/trace.txt
Jun-07 16:59:55.015 [main] DEBUG nextflow.script.ScriptRunner - > Script parsing
Jun-07 16:59:55.390 [main] DEBUG nextflow.script.ScriptRunner - > Launching execution
Jun-07 16:59:55.393 [main] WARN  nextflow.script.ScriptBinding - Access to undefined parameter `help` -- Initialise it to a default value eg. `params.help = some_value`
Jun-07 16:59:55.496 [PathVisitor-1] DEBUG nextflow.file.PathVisitor - files for syntax: glob; folder: /tick-genome/rna/pacbio-isoseq/2018-06-07/fake_genome_and_transcriptome/; pattern: *.fake_ref_transcriptome.fasta; options: [:]
Jun-07 16:59:55.497 [PathVisitor-1] DEBUG nextflow.file.FileHelper - Path matcher not defined by 'S3FileSystem' file system -- using default default strategy
Jun-07 16:59:55.575 [main] INFO  nextflow.Nextflow - ==================================================================
      _                            _       _ _         _ _
     | |_ ___ _____ ___ ___    ___|_|_____|_| |___ ___|_| |_ _ _
     | '_|___|     | -_|  _|  |_ -| |     | | | .'|  _| |  _| | |
     |_,_|   |_|_|_|___|_|    |___|_|_|_|_|_|_|__,|_| |_|_| |_  |
                                                            |___|

czbiohub/nf-kmer-similarity vnull"
==================================================================
Jun-07 16:59:55.583 [main] INFO  nextflow.Nextflow - Pipeline Name  : czbiohub/nf-kmer-similarity
Pipeline Version: null
Run Name       : mighty_snyder
Read Pairs     : false
Input fastas   : s3://tick-genome/rna/pacbio-isoseq/2018-06-07/fake_genome_and_transcriptome/*.fake_ref_transcriptome.fasta
SRA/ENA IDs    : false
Molecules      : dna,protein
K-mer sizes    : 21,27,33,51
Log2 sketch sizes: 8,9
Make one signature per record?: true
Max Memory     : 1.9 TB
Max CPUs       : 96
Max Time       : 10d
Output dir     : s3://tick-genome/rna/pacbio-isoseq/2018-06-07/fake_genome_and_transcriptome/transcriptome_kmer_similarity/
Working dir    : /tick-genome/nextflow-intermediates
Container Engine: docker
Container      : czbiohub/nf-kmer-similarity:dev
Current home   : /Users/olgabot
Current user   : olgabot
Current path   : /Users/olgabot/code/tick-workflows/kmer-similarity
Script dir     : /Users/olgabot/.nextflow/assets/czbiohub/nf-kmer-similarity
Config Profile : czbiohub_aws
Jun-07 16:59:55.584 [main] INFO  nextflow.Nextflow - =========================================
Jun-07 16:59:55.660 [main] DEBUG nextflow.processor.ProcessFactory - << taskConfig executor: awsbatch
Jun-07 16:59:55.661 [main] DEBUG nextflow.processor.ProcessFactory - >> processorType: 'awsbatch'
Jun-07 16:59:55.675 [main] DEBUG nextflow.executor.Executor - Initializing executor: awsbatch
Jun-07 16:59:55.679 [main] INFO  nextflow.executor.Executor - [warm up] executor > awsbatch
Jun-07 16:59:55.702 [main] DEBUG nextflow.util.ThrottlingExecutor - Creating throttling executor with opts: nextflow.util.ThrottlingExecutor$Options(poolName:AWSBatch-executor, limiter:RateLimiter[stableRate=50.0qps], poolSize:40, maxPoolSize:40, queueSize:5000, maxRetries:10, keepAlive:1m, autoThrottle:true, errorBurstDelay:1s, rampUpInterval:100, rampUpFactor:1.2, rampUpMaxRate:1.7976931348623157E308, backOffFactor:2.0, backOffMinRate:0.0166666667, retryDelay:1s)
Jun-07 16:59:55.714 [main] DEBUG nextflow.util.ThrottlingExecutor - Creating throttling executor with opts: nextflow.util.ThrottlingExecutor$Options(poolName:AWSBatch-reaper, limiter:RateLimiter[stableRate=50.0qps], poolSize:40, maxPoolSize:40, queueSize:5000, maxRetries:10, keepAlive:1m, autoThrottle:true, errorBurstDelay:1s, rampUpInterval:100, rampUpFactor:1.2, rampUpMaxRate:1.7976931348623157E308, backOffFactor:2.0, backOffMinRate:0.0166666667, retryDelay:1s)
Jun-07 16:59:55.715 [main] DEBUG n.cloud.aws.batch.AwsBatchExecutor - Creating parallel monitor for executor 'awsbatch' > pollInterval=10s; dumpInterval=5m
Jun-07 16:59:55.720 [main] DEBUG nextflow.processor.TaskDispatcher - Starting monitor: ParallelPollingMonitor
Jun-07 16:59:55.721 [main] DEBUG n.processor.TaskPollingMonitor - >>> barrier register (monitor: awsbatch)
Jun-07 16:59:55.725 [main] DEBUG nextflow.executor.Executor - Invoke register for executor: awsbatch
Jun-07 16:59:55.763 [main] DEBUG nextflow.Global - Using AWS credential defined in `default` section in file: /Users/olgabot/.aws/credentials
Jun-07 16:59:55.855 [main] DEBUG nextflow.Session - >>> barrier register (process: get_software_versions)
Jun-07 16:59:55.859 [main] DEBUG nextflow.processor.TaskProcessor - Creating operator > get_software_versions -- maxForks: 8
Jun-07 16:59:55.930 [main] DEBUG nextflow.util.CacheHelper - Config settings `withName:sourmash_compute_sketch` matches process sourmash_compute_sketch
Jun-07 16:59:55.933 [main] DEBUG nextflow.processor.ProcessFactory - << taskConfig executor: awsbatch
Jun-07 16:59:55.933 [main] DEBUG nextflow.processor.ProcessFactory - >> processorType: 'awsbatch'
Jun-07 16:59:55.933 [main] DEBUG nextflow.executor.Executor - Initializing executor: awsbatch
Jun-07 16:59:55.942 [main] DEBUG nextflow.Session - >>> barrier register (process: sourmash_compute_sketch)
Jun-07 16:59:55.942 [main] DEBUG nextflow.processor.TaskProcessor - Creating *combiner* operator for each param(s) at index(es): [0, 1]
Jun-07 16:59:55.953 [main] DEBUG nextflow.processor.TaskProcessor - Creating operator > sourmash_compute_sketch -- maxForks: 8
Jun-07 16:59:55.986 [main] DEBUG nextflow.util.CacheHelper - Config settings `withName:sourmash_compare_sketches` matches process sourmash_compare_sketches
Jun-07 16:59:55.987 [main] DEBUG nextflow.processor.ProcessFactory - << taskConfig executor: awsbatch
Jun-07 16:59:55.987 [main] DEBUG nextflow.processor.ProcessFactory - >> processorType: 'awsbatch'
Jun-07 16:59:55.987 [main] DEBUG nextflow.executor.Executor - Initializing executor: awsbatch
Jun-07 16:59:55.988 [main] DEBUG nextflow.Session - >>> barrier register (process: sourmash_compare_sketches)
Jun-07 16:59:55.988 [main] DEBUG nextflow.processor.TaskProcessor - Creating operator > sourmash_compare_sketches -- maxForks: 8
Jun-07 16:59:55.991 [main] DEBUG nextflow.script.ScriptRunner - > Await termination 
Jun-07 16:59:55.991 [main] DEBUG nextflow.Session - Session await
Jun-07 16:59:56.037 [Actor Thread 8] ERROR nextflow.processor.TaskProcessor - Error executing process > 'sourmash_compute_sketch (tick0.fake_ref_transcriptome_null)'

Caused by:
  Unknown variable 'log2_sketch_size' -- Make sure it is not misspelt and defined somewhere in the script before using it

Source block:
  sketch_id = "molecule-${molecule}_ksize-${ksize}_log2sketchsize-${log2_sketch_size}"
  molecule = molecule
  ksize = ksize
  if ( params.one_signature_per_record ){
    """
    sourmash compute \
      --num-hashes \$((2**$log2_sketch_size)) \
      --ksizes $ksize \
      --$molecule \
      --output ${sample_id}_${sketch_id}.sig \
      $reads
    """
  } else {
    """
    sourmash compute \
      --num-hashes \$((2**$log2_sketch_size)) \
      --ksizes $ksize \
      --$molecule \
      --output ${sample_id}_${sketch_id}.sig \
      --merge '$sample_id' $reads
    """
  }

Tip: when you have fixed the problem you can continue the execution appending to the nextflow command line the option `-resume`
Jun-07 16:59:56.043 [Actor Thread 8] DEBUG nextflow.Session - Session aborted -- Cause: Process `null` script contains error(s)
Jun-07 16:59:56.068 [Actor Thread 8] DEBUG nextflow.Session - The following nodes are still active:
[process] get_software_versions
  status=ACTIVE
  port 0: (cntrl) -     ; channel: $

[process] sourmash_compute_sketch
  status=ACTIVE
  port 0: (value) bound ; channel: __$eachinparam<0>
  port 1: (value) bound ; channel: __$eachinparam<1>
  port 2: (queue) OPEN  ; channel: -
  port 3: (cntrl) -     ; channel: $

[process] sourmash_compare_sketches
  status=ACTIVE
  port 0: (queue) OPEN  ; channel: -
  port 1: (cntrl) -     ; channel: $

Jun-07 16:59:56.075 [Task monitor] DEBUG n.processor.TaskPollingMonitor - <<< barrier arrives (monitor: awsbatch)
Jun-07 16:59:56.077 [main] DEBUG nextflow.Session - Session await > all process finished
Jun-07 16:59:56.078 [main] DEBUG nextflow.Session - Session await > all barriers passed
Jun-07 16:59:56.089 [main] ERROR nextflow.script.WorkflowMetadata - Failed to invoke `workflow.onComplete` event handler
java.io.FileNotFoundException: /Users/olgabot/.nextflow/assets/czbiohub/nf-kmer-similarity/assets/email_template.txt (No such file or directory)
	at java.io.FileInputStream.open0(Native Method)
	at java.io.FileInputStream.open(FileInputStream.java:195)
	at java.io.FileInputStream.<init>(FileInputStream.java:138)
	at java.io.FileReader.<init>(FileReader.java:72)
	at groovy.text.TemplateEngine.createTemplate(TemplateEngine.java:43)
	at groovy.text.TemplateEngine$createTemplate.call(Unknown Source)
	at org.codehaus.groovy.runtime.callsite.CallSiteArray.defaultCall(CallSiteArray.java:47)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:115)
	at org.codehaus.groovy.runtime.callsite.AbstractCallSite.call(AbstractCallSite.java:127)
	at _nf_script_9fd82d26$_run_closure9.doCall(_nf_script_9fd82d26:460)
	at _nf_script_9fd82d26$_run_closure9.doCall(_nf_script_9fd82d26)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:101)
	at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:323)
	at org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:263)
	at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1041)
	at groovy.lang.Closure.call(Closure.java:405)
	at groovy.lang.Closure.call(Closure.java:399)
	at nextflow.script.WorkflowMetadata$_invokeOnComplete_closure4.doCall(WorkflowMetadata.groovy:369)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:101)
	at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:323)
	at org.codehaus.groovy.runtime.metaclass.ClosureMetaClass.invokeMethod(ClosureMetaClass.java:263)
	at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1041)
	at groovy.lang.Closure.call(Closure.java:405)
	at groovy.lang.Closure.call(Closure.java:421)
	at org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:2296)
	at org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:2281)
	at org.codehaus.groovy.runtime.DefaultGroovyMethods.each(DefaultGroovyMethods.java:2322)
	at nextflow.script.WorkflowMetadata.invokeOnComplete(WorkflowMetadata.groovy:367)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.codehaus.groovy.reflection.CachedMethod.invoke(CachedMethod.java:101)
	at groovy.lang.MetaMethod.doMethodInvoke(MetaMethod.java:323)
	at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1217)
	at groovy.lang.MetaClassImpl.invokeMethod(MetaClassImpl.java:1041)
	at org.codehaus.groovy.runtime.InvokerHelper.invokePogoMethod(InvokerHelper.java:1011)
	at org.codehaus.groovy.runtime.InvokerHelper.invokeMethod(InvokerHelper.java:994)
	at org.codehaus.groovy.runtime.InvokerHelper.invokeMethodSafe(InvokerHelper.java:97)
	at nextflow.script.WorkflowMetadata$_closure3.doCall(WorkflowMetadata.groovy:233)
	at nextflow.script.WorkflowMetadata$_closure3.call(WorkflowMetadata.groovy)
	at nextflow.Session.shutdown0(Session.groovy:671)
	at nextflow.Session.destroy(Session.groovy:623)
	at nextflow.script.ScriptRunner.terminate(ScriptRunner.groovy:389)
	at nextflow.script.ScriptRunner.execute(ScriptRunner.groovy:172)
	at nextflow.cli.CmdRun.run(CmdRun.groovy:245)
	at nextflow.cli.Launcher.run(Launcher.groovy:449)
	at nextflow.cli.Launcher.main(Launcher.groovy:626)
Jun-07 16:59:56.101 [main] DEBUG nextflow.trace.StatsObserver - Workflow completed > WorkflowStats[succeedCount=0; failedCount=0; ignoredCount=0; cachedCount=0; succeedDuration=0ms; failedDuration=0ms; cachedDuration=0ms]
Jun-07 16:59:56.102 [main] DEBUG nextflow.trace.TraceFileObserver - Flow completing -- flushing trace file
Jun-07 16:59:56.104 [main] DEBUG nextflow.trace.ReportObserver - Flow completing -- rendering html report
Jun-07 16:59:56.112 [main] DEBUG nextflow.trace.ReportObserver - Execution report summary data:
  {}
Jun-07 16:59:57.221 [main] DEBUG nextflow.trace.TimelineObserver - Flow completing -- rendering html timeline
Jun-07 16:59:57.456 [main] DEBUG nextflow.CacheDB - Closing CacheDB done
Jun-07 16:59:57.460 [main] DEBUG nextflow.Session - AWS S3 uploader shutdown
Jun-07 16:59:57.472 [main] DEBUG nextflow.script.ScriptRunner - > Execution complete -- Goodbye
